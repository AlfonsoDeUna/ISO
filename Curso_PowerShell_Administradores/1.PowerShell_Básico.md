# Introducción a PowerShell: Conceptos Básicos

Este documento contiene los apuntes y ejemplos de código vistos en clase. Hemos cubierto desde la gestión de variables hasta el control de flujo con condicionales.

## 1. Variables y Tipos de Datos

En PowerShell, todas las variables comienzan con el símbolo `$`. Aunque el lenguaje es de tipado dinámico, es importante conocer cómo manejar los datos.

### Variables de Usuario y de Sistema
```powershell
# Definición de una variable de texto (String)
$nombre = "alfonso"
$nombre

# Definición de un número entero (Int)
$numero_entero = 10

# Variables del sistema (automáticas)
$home  # Muestra la ruta de la carpeta personal del usuario

# Variables especiales (Booleanas y nulas)
$true   # Representa Verdadero
$false  # Representa Falso
$null   # Representa el vacío

```

### Tipos de Datos Específicos

Podemos forzar el tipo de dato usando corchetes:

* `[int]`: Números enteros.
* `[double]` o `[float]`: Números con decimales.
* `[bool]`: Valores lógicos.

```powershell
$decimal = 4.45
$logica = $true  # Guardamos un valor de verdad

```

Convertir un texto a un su número entero

```powershell
$numero = [int] "5"
```

Pedir un número al usuario, guardarlo en una variable y convertirlo a entero
```powershell
$numero = [int] (read-Host "Dime un número")
```

## 2. Almacenar Salida de Comandos

Podemos capturar lo que devuelve un comando de PowerShell en una variable.

```powershell
$hoy = Get-Date      # Guarda la fecha y hora actual
$directorios = dir   # Guarda el listado de archivos y carpetas (Alias de Get-ChildItem)

```

---

## 3. Ejercicio: Intercambio de Variables

Para intercambiar el valor de dos variables sin perder los datos, necesitamos una **variable auxiliar**.

```powershell
$numero1 = 20
$numero2 = 30

# Lógica de intercambio
$numero_temporal = $numero1  # Guardamos el 20 temporalmente
$numero1 = $numero2          # numero1 ahora vale 30
$numero2 = $numero_temporal  # numero2 ahora toma el valor guardado (20)

```

## 4. Expresiones y Operaciones

PowerShell permite realizar cálculos matemáticos y manipular cadenas de texto de forma intuitiva.

```powershell
$suma = $numero1 + $numero2 
$mul = $numero1 * $numero2
$div = 5 / 2                 # Devuelve 2.5
$resta = $numero1 - $numero2
$resto_div = 5 % 2           # Devuelve el sobrante de la división (1)

# Manipulación de texto
"hola" + " mundo"            # Concatenación: "hola mundo"
"ja" * 4                     # Repetición: "jajajaja"

```

## 5. Interacción y Salida

```powershell
# Escribir en la consola
Write-Host "El valor de la suma es: $suma"

# Pedir datos al usuario
$edad = Read-Host "¿Qué edad tienes?"

```

## 6. Operadores de Comparación y Lógica

En PowerShell no usamos símbolos como `>` o `<`. Usamos abreviaturas:

| Operador | Descripción | Ejemplo |
| --- | --- | --- |
| `-eq` | Equal (Igual) | `2 -eq 2` (True) |
| `-ne` | Not Equal (Distinto) | `2 -ne 2` (False) |
| `-gt` | Greater Than (Mayor que) | `5 -gt 4` (True) |
| `-lt` | Less Than (Menor que) | `3 -lt 4` (True) |
| `-ge` | Greater or Equal (Mayor o igual) | `5 -ge 5` (True) |
| `-le` | Less or Equal (Menor o igual) | `2 -le 1` (False) |

**Operadores lógicos:**

* `-and`: Se cumple si ambas condiciones son ciertas.
* `-or`: Se cumple si al menos una es cierta.
* `-not`: Invierte el valor lógico.


## 7. Condicionales (if / else)

La estructura `if` permite tomar decisiones basadas en si una condición es verdadera o falsa.

```powershell
if (2 -eq 2) {
    # Se ejecuta si la condición es $true
    Write-Host "Esto es verdadero"
    Write-Host "Hola mundo"
} 
else {
    # Se ejecuta si la condición es $false
    Write-Host "Esto es falso"
}
```

## 8. Estructuras Condicionales Múltiples (if, elseif, else)

Cuando tenemos más de dos posibilidades, utilizamos `elseif`. Esto permite evaluar varias condiciones en orden: si la primera no se cumple, se comprueba la siguiente, y así sucesivamente.

### Ejemplo: Calculadora Básica
En este ejemplo, usamos `[int]` para convertir el texto que introduce el usuario en números reales, permitiendo realizar operaciones matemáticas.

```powershell
# Solicitud de datos
$numero1 = Read-Host "Dime el primer número"
$numero2 = Read-Host "Dime el segundo número"

$operacion = Read-Host "Dime la operación (*, /, +, -)"

# Lógica de decisión
if ($operacion -eq "*") {
    $resultado = [int]$numero1 * [int]$numero2
} 
elseif ($operacion -eq "/") {
    $resultado = [int]$numero1 / [int]$numero2
} 
elseif ($operacion -eq "+") {
    $resultado = [int]$numero1 + [int]$numero2
} 
elseif ($operacion -eq "-") {
    $resultado = [int]$numero1 - [int]$numero2
} 
else {
    Write-Host "Operación no válida" -ForegroundColor Red
}

Write-Host "El resultado es: $resultado" -ForegroundColor Cyan

```


## 9. Arrays (Listas ordenadas)

Un **Array** es como una caja  donde puedes guardar varios valores bajo un mismo nombre. En lugar de tener `$nombre1`, `$nombre2`, `$nombre3`, guardamos todo en una sola lista.

### Cómo crear un Array

Se define separando los elementos por comas:

```powershell
# Crear un array de nombres
$alumnos = "Alfonso", "Juan", "Maria", "Elena"

# También podemos crear el array
$alumnos = @("Alfonso", "Juan", "Maria", "Elena")

# Acceder a un elemento (¡Se empieza a contar desde 0!)
$alumnos[0]  # Devuelve "Alfonso"
$alumnos[2]  # Devuelve "Maria"

```

## 10. Bucle ForEach (Para cada uno)

El bucle `foreach` se utiliza para recorrer los Arrays. Imagina que tienes una lista de invitados y quieres saludar a cada uno individualmente; el `foreach` toma a cada persona de la lista y ejecuta una acción con ella.

### Estructura:

`foreach ($variable_individual in $lista_completa) { ... }`

```powershell
$coches = "Renault", "Opel", "BMW", "Mercedes"

foreach ($coche in $coches) {
    Write-Host "La marca del coche del parking: $coche"
}
```

### Explicación sencilla:

1. **`$coches`**: Es el Array (la cesta completa).
2. **`$coche`**: Es una variable temporal que representa el elemento actual que estamos procesando.
3. **El código entre `{ }**`: Se repetirá tantas veces como elementos haya en la cesta.

---

## 11. Ejercicio Combinado

Imagina que queremos saludar a una lista de usuarios, pero solo si no son "Admin".

```powershell
$usuarios = "Pepe", "Admin", "Luis", "Marta"

foreach ($u in $usuarios) {
    if ($u -eq "Admin") {
        Write-Host "Saltando al administrador..." -ForegroundColor Yellow
    } else {
        Write-Host "Hola usuario: $u"
    }
}

```
