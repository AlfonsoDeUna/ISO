
# Guía de PowerShell: Cmdlets y Manipulación de Objetos

Esta guía cubre los fundamentos de la línea de comandos de PowerShell, desde la obtención de ayuda hasta la manipulación avanzada de objetos mediante *pipelines*.

## 1. Ayuda y Sistema

Antes de empezar, es fundamental saber cómo explorar las herramientas disponibles.

| Cmdlet | Descripción |
| --- | --- |
| `Get-Help <cmdlet>` | Muestra la ayuda básica del comando. |
| `Get-Help <cmdlet> -Examples` | Muestra ejemplos prácticos de uso. |
| `Get-Help <cmdlet> -Online` | Abre la documentación oficial en el navegador. |
| `Get-Command *process*` | Busca todos los cmdlets que contengan la palabra "process". |
| `Get-Member` | **Crucial:** Muestra las propiedades y métodos de un objeto. |

```powershell
# Verificar versión de PowerShell
$PSVersionTable.PSVersion
# O también:
get-host

```

## 2. El Pipeline (Canalización) `|`

En PowerShell, el pipe no pasa texto, pasa **objetos completos**. Esto permite filtrar y ordenar sin necesidad de herramientas externas.

### Ordenación (`Sort-Object`)

```powershell
# Ordenar procesos por CPU de forma descendente
Get-Process | Sort-Object CPU -Descending

# Ordenar por uso de memoria (WorkingSet)
Get-Process | Sort-Object WorkingSet64 -Descending

```

### Selección de Propiedades (`Select-Object`)

Permite reducir el objeto solo a las columnas que nos interesan.

```powershell
# Seleccionar solo nombre y CPU de los primeros 5
Get-Process | Select-Object Name, CPU -First 5

```

## 3. Filtrado Avanzado (`Where-Object`)

Esta es la parte más potente de la manipulación de objetos. Permite aplicar lógica condicional.

```powershell
# Obtener procesos que consumen más de 500MB de memoria
Get-Process | Where-Object { $_.WorkingSet64 -gt 500MB }

# Obtener procesos que se llaman "svchost"
Get-Process | Where-Object { $_.Name -eq "svchost" }

```

> **Nota:** `$_` representa al "objeto actual" que viaja por la tubería.


## 4. Visualización y Salida

PowerShell permite formatear la salida para lectura humana o para persistencia en archivos.

### Formatos de pantalla

* **Format-Table (ft):** Vista tabular (columnas).
* **Format-List (fl):** Vista de lista (todas las propiedades detalladas).
* **Out-GridView:** Abre una ventana interactiva de Windows para filtrar manualmente.

```porwershell
get-process | format-table name, id, cpu

get-process | format-list name, id, cpu

get-process | out-gridview
```

## 5. Agrupación y Métricas

Útil para reportes administrativos y análisis de rendimiento.

```powershell
# Agrupar procesos por nombre (para ver instancias duplicadas)
Get-Process | Group-Object Name

# Calcular estadísticas de memoria de todos los procesos
Get-Process | Measure-Object WorkingSet64 -Sum -Average -Maximum -Minimum

```

## 6. Ejemplos útiles

```powershell
# Exportar a archivo de texto plano
Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 | Out-File "procesos.txt"

# Exportar a CSV (Ideal para Excel)
Get-Process | Export-Csv -Path "reporte.csv" -NoTypeInformation

```
